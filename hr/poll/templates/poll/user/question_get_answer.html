{% extends 'base.html' %}

{% block content %}


<div class="container">
    <div class="row">

        {% if messages %}
			{% for message in messages %}
				<P	{% if message.tags %} class="col-12 mt-5 alert {{ message.tags }}" {% endif %} role="alert">
					{{ message }}
				</p>
			{% endfor %}
		{% endif %}

        <div class="col-12 mt-5">

            <div class="card">
                {% if question.image %}
                <img src="{{ question.image.url }}" class="card-img-top" alt="..." style="max-width: 540px;">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title">{{ question.text }}</h5>

                    <ul class="list-group mt-3">
                        {% for answer in question.answers.all %}
                        <li class="list-group-item">

                            {% if question.type == 2 %}
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="{{ forloop.counter0 }}">
                                <label class="form-check-label" for="{{ forloop.counter0 }}">
                                    {{ answer.text }}
                                </label>
                            </div>
                            {% endif %}
                            {% if question.type == 1 %}


                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="exampleRadios"
                                    id="{{ forloop.counter0 }}" value="option{{ forloop.counter0 }}">
                                <label class="form-check-label" for="{{ forloop.counter0 }}">
                                    {{ answer.text }}
                                </label>
                            </div>


                            {% endif %}

                        </li>
                        {% endfor %}
                    </ul>

                    <div class="col-12 mt-3">
                        <a onclick="save_answer({{ pk }});" , class="btn btn-outline-success btn-sm"
                            href="{{ return_path }}">Ответить</a>
                        <a class="btn btn-outline-secondary btn-sm" href="{{ return_path }}">Вернуться к списку
                            вопросов</a>
                    </div>
                </div>
            </div>


        </div>

    </div>
</div>

<script>
    function save_answer(pk) {
        let l = document.querySelectorAll('.form-check-input').length;
        let checked = '';
        for (let i = 0; i < l; i++) {
            if (document.getElementById(i).checked) {
                checked += '1';
            } else {
                checked += '0'
            }

        };
        console.log(checked)
        
        $.ajax({
            url: 'add/',
            data: {checked: checked, pk: pk},
            dataType: "html"
        });
        console.log('OK')
    }
</script>

{% endblock %}