{% extends 'base.html' %}

{% block content %}


<div class="container">
    <div class="row">
        <div class="col-12 mt-5">

            <div class="card">
                {% if question.image %}
                <img src="{{ question.image.url }}" class="card-img-top" alt="..." style="max-width: 540px;">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title">{{ question.text }}</h5>

                    <ul class="list-group mt-3">
                        {% for answer in question.answers.all %}
                        <li class="list-group-item">

                            {% if question.type == 2 %}
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="{{ forloop.counter0 }}">
                                <label class="form-check-label" for="{{ forloop.counter0 }}">
                                    {{ answer.text }}
                                </label>
                            </div>
                            {% endif %}
                            {% if question.type == 1 %}


                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="exampleRadios"
                                    id="{{ forloop.counter0 }}" value="option{{ forloop.counter0 }}">
                                <label class="form-check-label" for="{{ forloop.counter0 }}">
                                    {{ answer.text }}
                                </label>
                            </div>


                            {% endif %}

                        </li>
                        {% endfor %}
                    </ul>

                    <div class="col-12 mt-3">
                        <a onclick="save_answer({{ newpk }}, {{ pk }});" , class="btn btn-outline-success btn-sm"
                            href="{% url 'poll:index' %}">Ответить</a>
                        <a class="btn btn-outline-secondary btn-sm" href="{{ return_path }}">Вернуться к списку
                            вопросов</a>
                    </div>
                </div>
            </div>


        </div>

    </div>
</div>

<script>
    function save_answer(newpk, pk) {
        let l = document.querySelectorAll('.form-check-input').length;
        let answers = '';
        for (let i = 0; i < l; i++) {
            if (document.getElementById(i).checked) {
                answers += '1';
            } else {
                answers += '0'
            }

        };
        console.log(answers)
        
        $.ajax({
            url: 'add/',
            data: {valid: answers, pk: pk, newpk: newpk},
            dataType: "html",
            
        });
    }
</script>

{% endblock %}